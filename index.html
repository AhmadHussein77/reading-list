<!DOCTYPE html>
<html>
<head>
  <title>Brandon Amos: Reading List</title>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body onload="loadLists()">
  <h1>Brandon Amos: Reading List</h1>
  <h2>To Read</h2><div id="to-read"></div>
  <h2>Finished</h2><div id="finished"></div>
  <h2>Compilations</h2><div id="compilations"></div>
  <div id="footer">
Crafted by <a href="http://bamos.io/about">Brandon Amos</a>. |
<a href="http://github.com/bamos/reading-list">Open-sourced on GitHub</a>.
  </div>

  <script id="to-read-tmpl" type="text/x-handlebars-template">
<ul>
  {{#each this}}
    <li>
      {{ this.author }} - {{ this.title }}
    </li>
  {{/each}}
</ul>
  </script>
  <script id="finished-tmpl" type="text/x-handlebars-template">
<ul>
  {{#each this}}
    <li>
      {{ this.author }} - {{ this.title }}
      <ul>
        <li>Finished: {{this.finished}}
        <li>Rating: {{this.rating}}
      </ul>
    </li>
  {{/each}}
</ul>
  </script>
  <script id="comp-tmpl" type="text/x-handlebars-template">
<ul>
  {{#each this}}
    <li>
      <a href='{{ this.url }}' >{{ this.title }}</a>
    </li>
  {{/each}}
</ul>
  </script>


  <script src="//static.getclicky.com/js" type="text/javascript"></script>
  <script src="js/jquery-1.11.0.min.js"></script>
  <script src="js/js-yaml.min.js"></script>
  <script src="js/handlebars-v1.3.0.js"></script>
  <script type="text/javascript">
var to_read_tmpl = Handlebars.compile($('#to-read-tmpl').html());
var finished_tmpl = Handlebars.compile($('#finished-tmpl').html());
var comp_tmpl = Handlebars.compile($('#comp-tmpl').html());
function loadYAML(name, f) {
  var client = new XMLHttpRequest();
  client.open('GET', 'data/' + name + '.yaml');
  client.onreadystatechange = function() {
    var yaml = jsyaml.load(client.responseText);
    if (yaml) {
      f(yaml);
    }
  }
  client.send();
}
function loadLists() {
  loadYAML("to-read", function(yaml) {
    yaml.sort(function(a,b) {
      return a.author.localeCompare(b.author);
    });
    $("#to-read").html(to_read_tmpl(yaml));
  });
  loadYAML("finished", function(yaml) {
    yaml.sort(function(a,b) {
      if (a.finished > b.finished) return -1;
      if (a.finished < b.finished) return 1;
      return 0;
    });
    function dateString(d) {
      return d.getFullYear().toString() + "/" +
        d.getMonth().toString() + "/" +
        d.getDate().toString();
    }
    var len = yaml.length;
    for (var i = 0; i < len; i++) {
      yaml[i].finished = dateString(yaml[i].finished);
    }
    $("#finished").html(finished_tmpl(yaml));
  });
  loadYAML("compilations", function(yaml) {
    yaml.sort(function(a,b) {
      return a.title.localeCompare(b.title);
    });
    $("#compilations").html(comp_tmpl(yaml));
  });
}
try{ clicky.init(100602499); }catch(e){}
  </script>
</body>
</html>
